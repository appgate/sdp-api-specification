service-users:
  get:
    summary: List all Service Users.
    description: List all Service Users visible to current user.
    tags:
      - Service Users
    parameters:
      - $ref: './common.yml#/parameters/query'
      - $ref: './common.yml#/parameters/range'
      - $ref: './common.yml#/parameters/orderBy'
      - $ref: './common.yml#/parameters/descending'
      - $ref: './common.yml#/parameters/filterBy'
    responses:
      '200':
        description: List of Service Users.
        content:
          application/json:
            schema:
              $ref: '#/definitions/ServiceUserList'
      '401':
        $ref: './common.yml#/responses/TokenError'
      '403':
        $ref: './common.yml#/responses/PermissionError'
      '406':
        $ref: './common.yml#/responses/NotAcceptableError'
      '500':
        $ref: './common.yml#/responses/UnexpectedError'
  post:
    summary: Create a new Service User.
    description: Create a new Service User.
    tags:
      - Service Users
    responses:
      '200':
        description: Created Service User.
        content:
          application/json:
            schema:
              $ref: '#/definitions/ServiceUser'
      '400':
        $ref: './common.yml#/responses/JsonError'
      '401':
        $ref: './common.yml#/responses/TokenError'
      '403':
        $ref: './common.yml#/responses/PermissionError'
      '406':
        $ref: './common.yml#/responses/NotAcceptableError'
      '409':
        $ref: './common.yml#/responses/ConflictError'
      '422':
        $ref: './common.yml#/responses/ValidationError'
      '500':
        $ref: './common.yml#/responses/UnexpectedError'
    requestBody:
      $ref: '#/requestBodies/ServiceUserCreate'
service-users-id:
  get:
    summary: Get a specific Service User.
    description: Get a specific Service User.
    tags:
      - Service Users
    parameters:
      - $ref: './common.yml#/parameters/id'
    responses:
      '200':
        description: Single Service User.
        content:
          application/json:
            schema:
              $ref: '#/definitions/ServiceUser'
      '401':
        $ref: './common.yml#/responses/TokenError'
      '403':
        $ref: './common.yml#/responses/PermissionError'
      '404':
        $ref: './common.yml#/responses/NotFoundError'
      '406':
        $ref: './common.yml#/responses/NotAcceptableError'
      '500':
        $ref: './common.yml#/responses/UnexpectedError'
  put:
    summary: Update an existing Service User.
    description: Update an existing Service User.
    tags:
      - Service Users
    parameters:
      - $ref: './common.yml#/parameters/id'
    responses:
      '200':
        description: Updated Service User.
        content:
          application/json:
            schema:
              $ref: '#/definitions/ServiceUser'
      '400':
        $ref: './common.yml#/responses/JsonError'
      '401':
        $ref: './common.yml#/responses/TokenError'
      '403':
        $ref: './common.yml#/responses/PermissionError'
      '404':
        $ref: './common.yml#/responses/NotFoundError'
      '406':
        $ref: './common.yml#/responses/NotAcceptableError'
      '422':
        $ref: './common.yml#/responses/ValidationError'
      '500':
        $ref: './common.yml#/responses/UnexpectedError'
    requestBody:
      $ref: '#/requestBodies/ServiceUser'
  delete:
    summary: Delete a specific Service User.
    description: Delete a specific Service User.
    tags:
      - Service Users
    parameters:
      - $ref: './common.yml#/parameters/id'
    responses:
      '204':
        description: Service User was deleted successfully.
      '401':
        $ref: './common.yml#/responses/TokenError'
      '403':
        $ref: './common.yml#/responses/PermissionError'
      '404':
        $ref: './common.yml#/responses/NotFoundError'
      '406':
        $ref: './common.yml#/responses/NotAcceptableError'
      '500':
        $ref: './common.yml#/responses/UnexpectedError'

requestBodies:
  ServiceUser:
    content:
      application/json:
        schema:
          $ref: '#/definitions/ServiceUser'
    description: Service User object.
    required: true
  ServiceUserCreate:
    content:
      application/json:
        schema:
          allOf:
            - $ref: '#/definitions/ServiceUser'
            - required:
                - password
    description: Service User object.
    required: true

definitions:
  ServiceUserList:
    allOf:
      - $ref: './common.yml#/definitions/ResultList'
      - type: object
        description: Represents a list of Service Users.
        properties:
          data:
            type: array
            description: List of Service Users.
            items:
              $ref: '#/definitions/ServiceUser'
  ServiceUser:
    allOf:
      - $ref: './common.yml#/definitions/BaseEntity'
      - type: object
        description: Represents a Service User.
        properties:
          labels:
            type: object
            description: Labels of the service. Will be used as claim.
            additionalProperties:
              type: string
          password:
            type: string
            format: password
            writeOnly: true
            description: Password for the user. Omit the field to keep the old password when updating a user.
            example: 'tSW3!QBv(rj{UuLY'
          disabled:
            type: boolean
            description: If true, the user will not be able to login.
          failedLoginAttempts:
            type: number
            description: Number of wrong password login attempts since last successiful login.
            example: 0
          lockStart:
            type: string
            format: date-time
            description: >-
              The date time when the user got locked out.
              A service user is locked out of the system after X amount of consecutive failed login attempts, where X is configurable in the service Identity Provider.
              The lock is in effect for Y minute(s), where Y is configurable in the service Identity Provider.
              When the user logs in successfully, this field becomes null.
